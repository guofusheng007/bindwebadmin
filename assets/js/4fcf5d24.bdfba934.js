"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[376],{816:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>m,default:()=>T,frontMatter:()=>t,metadata:()=>o,toc:()=>s});var a=r(5893),i=r(1151);const t={title:"\u6570\u636e\u5e93\u7ed3\u6784\u8868",sidebar_position:1,description:"\u6570\u636e\u5e93\u7ed3\u6784\u8868."},m=void 0,o={id:"docs/sider/advanced/db",title:"\u6570\u636e\u5e93\u7ed3\u6784\u8868",description:"\u6570\u636e\u5e93\u7ed3\u6784\u8868.",source:"@site/docs/docs/sider/advanced/db.md",sourceDirName:"docs/sider/advanced",slug:"/docs/sider/advanced/db",permalink:"/docs/docs/sider/advanced/db",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"\u6570\u636e\u5e93\u7ed3\u6784\u8868",sidebar_position:1,description:"\u6570\u636e\u5e93\u7ed3\u6784\u8868."},sidebar:"oswSidebar",previous:{title:"\u8fdb\u9636\u6307\u5357",permalink:"/docs/category/\u8fdb\u9636\u6307\u5357"},next:{title:"\u63a5\u53e3\u5f00\u53d1",permalink:"/docs/docs/sider/advanced/api"}},d={},s=[];function L(n){const e={code:"code",pre:"pre",...(0,i.a)(),...n.components};return(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-sql",children:"CREATE DATABASE IF NOT EXISTS `BindDB_TEST` DEFAULT CHARACTER SET utf8mb3;\r\nUSE `BindDB_TEST`;\r\n\r\n-- \u57df\u540dsoa\u8bb0\u5f55\u8868\u3002\u5728\u6ce8\u518c\u57df\u540d\u65f6\uff0c\u9700\u6838\u67e5\u57df\u540d\u662f\u5426\u5df2\u5b58\u5728\uff0c\u82e5\u5b58\u5728\uff0c\u5219\u4e0d\u5141\u8bb8\u6ce8\u518c\u3002\r\nCREATE TABLE IF NOT EXISTS `Zones` (\r\n    `id` int(11) NOT NULL AUTO_INCREMENT,                         /* \u5bf9\u5e94 ZoneData\u8868\u4e2d\u7684zone_id */\r\n    `user_name` varchar(128) NOT NULL,                            /* \u65b0\u589e\u9879,\u5bf9\u5e94UserList\u8868\u4e2duser_name\u6863\u4f4d\u3002\u56e0\u4e3a\u7528\u6237\u8868\u4e2d\u7684id\u662f\u4f1a\u53d8\u5316\u7684\uff0c\u4e0d\u5229\u4e8e\u540e\u5176\u6570\u636e\u5907\u4efd\u548c\u6062\u590d */\r\n    `domain` varchar(128) NOT NULL DEFAULT '',                    -- \u57df\u540d\r\n    `host` varchar(128) NOT NULL DEFAULT '',                      -- \u4e3bNS\uff0c\u53ef\u4ee5\u662fZoneData\u8868\u4e2dname\u6863\u4f4d\u7684\u503c(A\u8bb0\u5f55\u7c7b\u578b)\uff0c \u4e5f\u53ef\u4ee5\u662f\u5b8c\u6574\u7684\u57df\u540d(\u5fc5\u987b\u4ee5\u70b9(.)\u4e3a\u7ed3\u5c3e\r\n    `admin` varchar(128) NOT NULL DEFAULT 'info',                 -- \u7ba1\u7406\u5458\r\n    `serial` int(11) NOT NULL DEFAULT '2024060100',               -- \u683c\u5f0f\u4e3a\u201c\u5e74\u6708\u65e5+\u4fee\u6539\u6b21\u6570\u201d\uff0c\u5373\u201cYYMMDDxx\u201d,\u5176\u4e2dxx\u4e3a00\u81f399\u3002\r\n    `expire` int(11) NOT NULL DEFAULT '86400',                    -- \u8bb0\u5f55\u8fc7\u671f\u65f6\u95f4\uff0c\u5f53slave\u4e00\u76f4\u672a\u80fd\u6210\u529f\u4e0emaster\u53d6\u5f97\u8054\u7edc\uff0c\u90a3\u4e48\u5230\u8fd9\u91cc\u5c31\u4f1a\u653e\u5f03\u66f4\u65b0\uff0c\u540c\u65f6\u8fd9\u7684\u6570\u636e\u4e5f\u4f1a\u8fc7\u671f\u3002\r\n    `refresh` int(11) NOT NULL DEFAULT '86400',                   -- \u8fd9\u91cc\u662f\u544a\u8bc9slave\u9694\u591a\u4e45\u66f4\u65b0\u4e00\u6b21\u3002\r\n    `retry` int(11) NOT NULL DEFAULT '86400',                     -- slave\u5728\u8fdb\u884c\u66f4\u65b0\u5931\u8d25\u540e\uff0c\u8981\u9694\u591a\u4e45\u518d\u8fdb\u884c\u91cd\u8bd5\u3002\r\n    `minimum` int(11) NOT NULL DEFAULT '86400',                   -- \u9884\u8bbe\u7684\u6700\u5c0fTTL\u503c\r\n    `ttl` int(11) NOT NULL DEFAULT '86400',                       -- TTL\r\n    `writeable` tinyint(1) NOT NULL DEFAULT '1',                  -- bool\u7c7b\u578b\u30020(false),1(true),NULL\r\n    `active` tinyint(1) NOT NULL DEFAULT '1',                     -- \u89e3\u6790\u662f\u5426\u6709\u6548\u30021\u53ef\u4ee5\u89e3\u6790\uff0c0\u4e0d\u53ef\u4ee5\u89e3\u6790\u3002\r\n    `registe_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,   -- \u6ce8\u518c\u65f6\u95f4\r\n    `remark` varchar(128) NOT NULL DEFAULT '',                    /* \u5907\u6ce8 */\r\n    PRIMARY KEY (`id`),\r\n    KEY `domain_idx` (`domain`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;\r\n\r\ninsert into `Zones`\r\n    ( `user_name`,`domain`, `host`) VALUES\r\n    ('admin','mm-dns.com', 'ns1.mm-dns.com.'),\r\n    ('demo','example.com', 'ns1.mm-dns.com.'),\r\n    ('demo','test.io',  'ns1.mm-dns.com.');\r\n    \r\n-- \u57df\u540d\u666e\u901a\u8bb0\u5f55\u8868\r\nCREATE TABLE IF NOT EXISTS `ZoneData` (\r\n    `id` int(11) NOT NULL AUTO_INCREMENT,\r\n    `zone_id` int(11) NOT NULL,                                   -- \u57df\u540dsoa\u8bb0\u5f55id,\u5bf9\u5e94Zones\u8868\u7684id\u6863\u4f4d\u3002\r\n    `domain` varchar(128) NOT NULL,                               -- \u65b0\u589e\u9879,\u5bf9\u5e94Zones\u8868\u4e2d\u7684domain\u9879\u3002\u56e0\u4e3aZones\u8868id\u662f\u53d8\u5316\u7684\uff0c\u4e0d\u5229\u4e8e\u540e\u5176\u6570\u636e\u5907\u4efd\u548c\u6062\u590d\r\n    `user_name` varchar(128) NOT NULL,                            /* \u65b0\u589e\u9879,\u5bf9\u5e94UserList\u8868\u4e2duser_name\u6863\u4f4d */\r\n    `name` varchar(128) NOT NULL DEFAULT '',                      -- \u8bb0\u5f55\u540d\u79f0\r\n    `type` varchar(16) NOT NULL DEFAULT '',                       -- \u8bb0\u5f55\u7684\u7c7b\u578b\r\n    `data` varchar(256) NOT NULL DEFAULT '',                      -- \u89e3\u6790\u6570\u636e.\u6240\u4ee5\u5728\u57df\u540d\u4e3a\u503c\u65f6\uff0c\u5fc5\u987b\u4ee5\".\"\u70b9\u7b26\u53f7\u4e3a\u7ed3\u5c3e\u3002\r\n    `ttl` int(11) NOT NULL DEFAULT '120',                         -- TTL. 86400 = 60 * 60 * 24\r\n    `active` tinyint(1) NOT NULL DEFAULT '1',                     -- \u89e3\u6790\u662f\u5426\u6709\u6548\u30021\u53ef\u4ee5\u89e3\u6790\uff0c0\u4e0d\u53ef\u4ee5\u89e3\u6790\u3002\r\n    `token` varchar(128) NOT NULL DEFAULT '',                     /* \u65b0\u589e\u9879,\u7528\u4e8eapi\u65b9\u5f0f\u66f4\u65b0\u57df\u540d\u89e3\u6790\u3002token\u4e2d\u5b58\u50a8\u8be5\u57df\u540d\u7684TTL\u503c */\r\n    `registe_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,   -- \u6ce8\u518c\u65f6\u95f4\r\n    `remark` varchar(128) NOT NULL DEFAULT '',                    /* \u5907\u6ce8,128\u8868\u793a\u662f128\u4e2a\u5b57\u7b26 */\r\n    PRIMARY KEY (`id`),\r\n    KEY `zone_idx` (`zone_id`),\r\n    KEY `name_idx` (`zone_id`, `name`),\r\n    KEY `type_idx` (`type`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;\r\n\r\ninsert into `ZoneData`\r\n    (`zone_id`, `domain`, `user_name`,`name`, `type`, `data`) VALUES\r\n    (1,  'mm-dns.com','admin', '@', 'NS', 'ns1.mm-dns.com.'),\r\n    (1,  'mm-dns.com','admin','@', 'NS', 'ns2.mm-dns.com.'),\r\n    (1,  'mm-dns.com','admin','ns1', 'A', '192.168.3.52'),\r\n    (1,  'mm-dns.com','admin','ns2', 'A', '192.168.3.52'),\r\n    (2,  'example.com','demo', '@', 'NS', 'ns1.mm-dns.com.'),\r\n    (2,  'example.com','demo','@', 'NS', 'ns2.mm-dns.com.'),\r\n    (2,  'example.com','demo','@', 'MX', '10 mail.example.com.'),\r\n    (2,  'example.com','demo', '@', 'A', '192.168.0.2'),\r\n    (2,  'example.com','demo','@', 'TXT', '\"v=spf1 ip:192.168.0.3 ~all\"'),\r\n    (2,  'example.com','demo', 'www', 'CNAME', 'example.com.'),\r\n    (2,  'example.com','demo','mail', 'A', '192.168.0.3'),\r\n    (3,  'test.io','demo', '@', 'NS', 'ns1.mm-dns.com.'),\r\n    (3,  'test.io','demo','@', 'NS', 'ns2.mm-dns.com.'),\r\n    (3,  'test.io','demo','@', 'MX', '10 mail.test.io.'),\r\n    (3,  'test.io','demo','@', 'A', '192.168.0.2'),\r\n    (3,  'test.io','demo','@', 'TXT', '\"v=spf1 ip:192.168.0.3 ~all\"'),\r\n    (3,  'test.io','demo','mail', 'A', '192.168.0.3'),\r\n    (3,  'test.io','demo','www', 'A', '192.168.1.222'),\r\n    (3,  'test.io','demo','oa', 'A', '192.168.1.222');\r\n\r\n\r\n-- \u7528\u6237\u5217\u8868\r\nCREATE TABLE IF NOT EXISTS `UserList` (\r\n    `id` int(11) NOT NULL AUTO_INCREMENT,                         /* \u7528\u6237id*/\r\n    `username` varchar(128) NOT NULL DEFAULT '',                  -- \u7528\u6237\u540d\u79f0\r\n    `password` varchar(128) NOT NULL DEFAULT '',                  -- \u5bc6\u7801\r\n    `address` varchar(128) NOT NULL DEFAULT '',                   -- \u5730\u5740\r\n    `email` varchar(128) NOT NULL DEFAULT '',                     -- email\r\n    `mobile` varchar(128) NOT NULL DEFAULT '',                    -- mobile\r\n    `company` varchar(128) NOT NULL DEFAULT '',                   -- \u516c\u53f8\u540d\u79f0\r\n    `website` varchar(128) NOT NULL DEFAULT '',                   -- \u516c\u53f8\u7f51\u7ad9\r\n    `registe_date` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,   -- \u6ce8\u518c\u65f6\u95f4\r\n    `remark` varchar(128) NOT NULL DEFAULT '',                    -- \u5907\u6ce8 \r\n    `active` tinyint(1) NOT NULL DEFAULT '1',                     -- \u7528\u6237\u662f\u5426\u6709\u6548\u30021(true),0(false)\r\n    `maxdomain` int(11) NOT NULL DEFAULT '50',                    -- \u7528\u6237\u6700\u591a\u53ef\u4ee5\u521b\u5efa\u7684\u57df\u540d\u6570\u91cf\r\n    `maxrecord` int(11) NOT NULL DEFAULT '2500',                  -- \u7528\u6237\u6700\u591a\u53ef\u4ee5\u521b\u5efa\u7684\u89e3\u6790\u6570\u91cf\r\n    PRIMARY KEY (`id`),\r\n    KEY `id_idx` (`id`)\r\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb3;\r\n\r\n-- \u9ed8\u8ba4\u5e10\u53f7:admin/admin1111mm,demo/demo1111mm\r\ninsert UserList (username,password,address,email,mobile,company,website,remark) values \r\n                ('admin','c4052862747f010e17be96baceaff2f89d6fb4a35cafc7c94c63af2bbe085d5c','shenzhen china','guofs@139.com','13751090806','bind-webadmin','https://www.bind-webadmin.com/','\u7a0b\u5e8f\u5458'),\r\n                ('demo','7ea51c8be7251e7bc404864386bf861a4d0b191e6e232567f93cb75c2789762a','shenzhen china','guofs@139.com','13751090806','bind-webadmin','https://www.bind-webadmin.com/','\u7a0b\u5e8f\u5458');\r\n\n"})})}function T(n={}){const{wrapper:e}={...(0,i.a)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(L,{...n})}):L(n)}},1151:(n,e,r)=>{r.d(e,{Z:()=>o,a:()=>m});var a=r(7294);const i={},t=a.createContext(i);function m(n){const e=a.useContext(t);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:m(n.components),a.createElement(t.Provider,{value:e},n.children)}}}]);